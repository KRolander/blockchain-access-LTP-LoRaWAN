const Web3 = require('web3')
var Tx = require('ethereumjs-tx').Transaction;

const Web3Utils = require('web3-utils');
var Eth = require('web3-eth');


const web3 = new Web3(new Web3.providers.HttpProvider('http://127.0.0.1:7545'))

const pricateKeyStr = 'deccb7a24c2c2b20f3f06bf85a807688c393e53270c265eefc1a6aa13a5396dc'
const privateKey = Buffer.from(pricateKeyStr, 'hex')

const from = '0x3BAB6793471d1BdE760D402A81F39B511f782119'

web3.eth.defaultAccount =  '0x3BAB6793471d1BdE760D402A81F39B511f782119'

const contractABI = [
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "IoTDevicePubKey",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "deviceType",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "counter",
				"type": "uint256"
			}
		],
		"name": "Get_Data",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "signatureR",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "signatureS",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "data",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "deviceType",
				"type": "string"
			}
		],
		"name": "Put_Data",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			},
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "bytes32",
				"name": "_bytes32",
				"type": "bytes32"
			}
		],
		"name": "bytes32ToString",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "pure",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"name": "deviceCounterStorage",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"name": "deviceDataStorage",
		"outputs": [
			{
				"internalType": "bytes",
				"name": "",
				"type": "bytes"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "deviceGeneralStorage",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"name": "deviceIDStorage",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "IoTDevicePubKey",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "deviceType",
				"type": "string"
			}
		],
		"name": "getCounterFromState",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "initLedger",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "addressPubkeys",
				"type": "address"
			},
			{
				"internalType": "string",
				"name": "pubkey",
				"type": "string"
			}
		],
		"name": "putAddressesToState",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "pubkey",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "id",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "deviceType",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "counter",
				"type": "uint256"
			}
		],
		"name": "putCounterToState",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "recoveredAddress",
				"type": "address"
			},
			{
				"internalType": "string",
				"name": "data",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "deviceType",
				"type": "string"
			}
		],
		"name": "putDataToState",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "pubkey",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "id",
				"type": "string"
			}
		],
		"name": "putIDsToState",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "compositKey",
				"type": "string"
			}
		],
		"name": "queryLedger",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "source",
				"type": "string"
			}
		],
		"name": "stringToBytes32",
		"outputs": [
			{
				"internalType": "bytes32",
				"name": "result",
				"type": "bytes32"
			}
		],
		"stateMutability": "pure",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "x",
				"type": "uint256"
			}
		],
		"name": "toBytes",
		"outputs": [
			{
				"internalType": "bytes",
				"name": "b",
				"type": "bytes"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "recoveredAddress",
				"type": "address"
			},
			{
				"internalType": "string",
				"name": "deviceType",
				"type": "string"
			}
		],
		"name": "verifIDStorage",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	}
]
const  rawSmartContract = '0x60806040526040518060400160405280600681526020017f69647e6b65790000000000000000000000000000000000000000000000000000815250600a908051906020019062000051929190620001b9565b506040518060400160405280600881526020017f646174617e6b6579000000000000000000000000000000000000000000000000815250600b90805190602001906200009f929190620001b9565b506040518060400160405280600b81526020017f636f756e7465727e6b6579000000000000000000000000000000000000000000815250600c9080519060200190620000ed929190620001b9565b506040518060400160405280600381526020017f456e640000000000000000000000000000000000000000000000000000000000815250600d90805190602001906200013b929190620001b9565b506040518060400160405280600481526020017f4564676500000000000000000000000000000000000000000000000000000000815250600e908051906020019062000189929190620001b9565b506000601060006101000a81548160ff021916908315150217905550348015620001b257600080fd5b50620002ce565b828054620001c79062000298565b90600052602060002090601f016020900481019282620001eb576000855562000237565b82601f106200020657805160ff191683800117855562000237565b8280016001018555821562000237579182015b828111156200023657825182559160200191906001019062000219565b5b5090506200024691906200024a565b5090565b5b80821115620002655760008160009055506001016200024b565b5090565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680620002b157607f821691505b60208210811415620002c857620002c762000269565b5b50919050565b6123fd80620002de6000396000f3fe608060405234801561001057600080fd5b506004361061010b5760003560e01c8063873f1db8116100a2578063cfb5192811610071578063cfb5192814610340578063d282c99214610370578063d7f047581461038c578063da464caa146103a8578063f46767ad146103d85761010b565b8063873f1db81461027f5780639201de55146102af578063b5aac04e146102df578063cc67764e1461030f5761010b565b806355cbf55e116100de57806355cbf55e146101d157806367f7206314610201578063775a8f5e146102315780637b4e5458146102615761010b565b80631fdd519314610110578063329264741461014057806338d079e81461017057806354119406146101a0575b600080fd5b61012a6004803603810190610125919061162d565b6103f4565b60405161013791906116f3565b60405180910390f35b61015a6004803603810190610155919061184a565b610494565b60405161016791906118db565b60405180910390f35b61018a600480360381019061018591906118f6565b6104e4565b604051610197919061196d565b60405180910390f35b6101ba60048036038101906101b59190611988565b61060e565b6040516101c89291906119d1565b60405180910390f35b6101eb60048036038101906101e69190611988565b610648565b6040516101f8919061196d565b60405180910390f35b61021b60048036038101906102169190611988565b61067e565b6040516102289190611a56565b60405180910390f35b61024b60048036038101906102469190611aa4565b610734565b6040516102589190611a56565b60405180910390f35b610269610791565b604051610276919061196d565b60405180910390f35b61029960048036038101906102949190611ad1565b610bb0565b6040516102a6919061196d565b60405180910390f35b6102c960048036038101906102c49190611b92565b610dca565b6040516102d691906116f3565b60405180910390f35b6102f960048036038101906102f49190611988565b610f65565b60405161030691906118db565b60405180910390f35b61032960048036038101906103249190611bbf565b610f93565b604051610337929190611c6d565b60405180910390f35b61035a60048036038101906103559190611988565b6110e2565b6040516103679190611ca5565b60405180910390f35b61038a6004803603810190610385919061184a565b61110c565b005b6103a660048036038101906103a19190611cc0565b61116e565b005b6103c260048036038101906103bd9190611d7b565b6111be565b6040516103cf91906116f3565b60405180910390f35b6103f260048036038101906103ed91906118f6565b6112d9565b005b6011602052806000526040600020600091509050805461041390611e35565b80601f016020809104026020016040519081016040528092919081815260200182805461043f90611e35565b801561048c5780601f106104615761010080835404028352916020019161048c565b820191906000526020600020905b81548152906001019060200180831161046f57829003601f168201915b505050505081565b600080600c846040516020016104ab929190611f37565b60405160208183030381529060405290506013816040516104cc9190611f5b565b90815260200160405180910390205491505092915050565b600080601160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020805461053190611e35565b80601f016020809104026020016040519081016040528092919081815260200182805461055d90611e35565b80156105aa5780601f1061057f576101008083540402835291602001916105aa565b820191906000526020600020905b81548152906001019060200180831161058d57829003601f168201915b505050505090506000600a826040516020016105c7929190611f37565b60405160208183030381529060405290506012816040516105e89190611f5b565b908152602001604051809103902060009054906101000a900460ff169250505092915050565b60606000826012846040516106239190611f5b565b908152602001604051809103902060009054906101000a900460ff1691509150915091565b6012818051602081018201805184825260208301602085012081835280955050505050506000915054906101000a900460ff1681565b60148180516020810182018051848252602083016020850120818352809550505050505060009150905080546106b390611e35565b80601f01602080910402602001604051908101604052809291908181526020018280546106df90611e35565b801561072c5780601f106107015761010080835404028352916020019161072c565b820191906000526020600020905b81548152906001019060200180831161070f57829003601f168201915b505050505081565b6060602067ffffffffffffffff8111156107515761075061171f565b5b6040519080825280601f01601f1916602001820160405280156107835781602001600182028036833780820191505090505b509050816020820152919050565b60008060405180608001604052806040518060600160405280604081526020016122c86040913981526020016040518060600160405280604081526020016123886040913981526020016040518060600160405280604081526020016123486040913981526020016040518060600160405280604081526020016123086040913981525090506000604051806080016040528073ef5861b9b65614f360d8f41f989bacc5c8761a4c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200173596774500dc74b9f9b057f4cea483a9d4523c36673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200173f6af77e5410ecb09b21ca7b89cb8ca34a8a4245773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200173968407f4a7298db58e9758d5e8defca0ca475ae373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815250905060006004905060005b81811015610b7d5761098583826004811061096357610962611f72565b5b602002015185836004811061097b5761097a611f72565b5b60200201516112d9565b610a3084826004811061099b5761099a611f72565b5b6020020151600a80546109ad90611e35565b80601f01602080910402602001604051908101604052809291908181526020018280546109d990611e35565b8015610a265780601f106109fb57610100808354040283529160200191610a26565b820191906000526020600020905b815481529060010190602001808311610a0957829003601f168201915b505050505061110c565b6000610b69858360048110610a4857610a47611f72565b5b6020020151600c8054610a5a90611e35565b80601f0160208091040260200160405190810160405280929190818152602001828054610a8690611e35565b8015610ad35780601f10610aa857610100808354040283529160200191610ad3565b820191906000526020600020905b815481529060010190602001808311610ab657829003601f168201915b5050505050600d8054610ae590611e35565b80601f0160208091040260200160405190810160405280929190818152602001828054610b1190611e35565b8015610b5e5780601f10610b3357610100808354040283529160200191610b5e565b820191906000526020600020905b815481529060010190602001808311610b4157829003601f168201915b50505050508461116e565b508080610b7590611fd0565b915050610945565b6012604051610b8b906120b1565b908152602001604051809103902060009054906101000a900460ff1694505050505090565b600080601160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208054610bfd90611e35565b80601f0160208091040260200160405190810160405280929190818152602001828054610c2990611e35565b8015610c765780601f10610c4b57610100808354040283529160200191610c76565b820191906000526020600020905b815481529060010190602001808311610c5957829003601f168201915b505050505090506000610c898285610494565b90506000610c9682611331565b90506000600b82604051602001610cae929190611f37565b604051602081830303815290604052905060008185604051602001610cd49291906120c6565b604051602081830303815290604052905087601482604051610cf69190611f5b565b90815260200160405180910390209080519060200190610d17929190611492565b50610dba85600c8054610d2990611e35565b80601f0160208091040260200160405190810160405280929190818152602001828054610d5590611e35565b8015610da25780601f10610d7757610100808354040283529160200191610da2565b820191906000526020600020905b815481529060010190602001808311610d8557829003601f168201915b505050505089600188610db591906120ea565b61116e565b6001955050505050509392505050565b606060005b60208160ff16108015610e215750600060f81b838260ff1660208110610df857610df7611f72565b5b1a60f81b7effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614155b15610e39578080610e319061214d565b915050610dcf565b60008160ff1667ffffffffffffffff811115610e5857610e5761171f565b5b6040519080825280601f01601f191660200182016040528015610e8a5781602001600182028036833780820191505090505b509050600091505b60208260ff16108015610ee45750600060f81b848360ff1660208110610ebb57610eba611f72565b5b1a60f81b7effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614155b15610f5b57838260ff1660208110610eff57610efe611f72565b5b1a60f81b818360ff1681518110610f1957610f18611f72565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508180610f539061214d565b925050610e92565b8092505050919050565b6013818051602081018201805184825260208301602085012081835280955050505050506000915090505481565b60008060008660001b905060008660001b90506000868051906020012090506000601b905060008060018484888860405160008152602001604052604051610fde9493929190612186565b6020604051602081039080840390855afa158015611000573d6000803e3d6000fd5b5050506020604051035191506001151561101a838b6104e4565b1515141561103d5761102d828b8b610bb0565b82975097505050505050506110d9565b60018460018561104d91906121cb565b88886040516000815260200160405260405161106c9493929190612186565b6020604051602081039080840390855afa15801561108e573d6000803e3d6000fd5b505050602060405103519050600115156110a8828b6104e4565b151514156110cb576110bb828b8b610bb0565b82975097505050505050506110d9565b600082975097505050505050505b94509492505050565b6000808290506000815114156110fe576000801b915050611107565b60208301519150505b919050565b600081836040516020016111219291906120c6565b604051602081830303815290604052905060016012826040516111449190611f5b565b908152602001604051809103902060006101000a81548160ff021916908315150217905550505050565b600083856040516020016111839291906120c6565b6040516020818303038152906040529050816013826040516111a59190611f5b565b9081526020016040518091039020819055505050505050565b606060006111cb83611331565b90506000600b826040516020016111e3929190611f37565b6040516020818303038152906040529050600081876040516020016112099291906120c6565b6040516020818303038152906040529050600060148260405161122c9190611f5b565b9081526020016040518091039020805461124590611e35565b80601f016020809104026020016040519081016040528092919081815260200182805461127190611e35565b80156112be5780601f10611293576101008083540402835291602001916112be565b820191906000526020600020905b8154815290600101906020018083116112a157829003601f168201915b50505050509050600081905080955050505050509392505050565b80601160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020908051906020019061132c929190611518565b505050565b60606000821415611379576040518060400160405280600181526020017f3000000000000000000000000000000000000000000000000000000000000000815250905061148d565b600082905060005b600082146113ab57808061139490611fd0565b915050600a826113a49190612231565b9150611381565b60008167ffffffffffffffff8111156113c7576113c661171f565b5b6040519080825280601f01601f1916602001820160405280156113f95781602001600182028036833780820191505090505b5090505b60008514611486576001826114129190612262565b9150600a856114219190612296565b603061142d91906120ea565b60f81b81838151811061144357611442611f72565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600a8561147f9190612231565b94506113fd565b8093505050505b919050565b82805461149e90611e35565b90600052602060002090601f0160209004810192826114c05760008555611507565b82601f106114d957805160ff1916838001178555611507565b82800160010185558215611507579182015b828111156115065782518255916020019190600101906114eb565b5b509050611514919061159e565b5090565b82805461152490611e35565b90600052602060002090601f016020900481019282611546576000855561158d565b82601f1061155f57805160ff191683800117855561158d565b8280016001018555821561158d579182015b8281111561158c578251825591602001919060010190611571565b5b50905061159a919061159e565b5090565b5b808211156115b757600081600090555060010161159f565b5090565b6000604051905090565b600080fd5b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006115fa826115cf565b9050919050565b61160a816115ef565b811461161557600080fd5b50565b60008135905061162781611601565b92915050565b600060208284031215611643576116426115c5565b5b600061165184828501611618565b91505092915050565b600081519050919050565b600082825260208201905092915050565b60005b83811015611694578082015181840152602081019050611679565b838111156116a3576000848401525b50505050565b6000601f19601f8301169050919050565b60006116c58261165a565b6116cf8185611665565b93506116df818560208601611676565b6116e8816116a9565b840191505092915050565b6000602082019050818103600083015261170d81846116ba565b905092915050565b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b611757826116a9565b810181811067ffffffffffffffff821117156117765761177561171f565b5b80604052505050565b60006117896115bb565b9050611795828261174e565b919050565b600067ffffffffffffffff8211156117b5576117b461171f565b5b6117be826116a9565b9050602081019050919050565b82818337600083830152505050565b60006117ed6117e88461179a565b61177f565b9050828152602081018484840111156118095761180861171a565b5b6118148482856117cb565b509392505050565b600082601f83011261183157611830611715565b5b81356118418482602086016117da565b91505092915050565b60008060408385031215611861576118606115c5565b5b600083013567ffffffffffffffff81111561187f5761187e6115ca565b5b61188b8582860161181c565b925050602083013567ffffffffffffffff8111156118ac576118ab6115ca565b5b6118b88582860161181c565b9150509250929050565b6000819050919050565b6118d5816118c2565b82525050565b60006020820190506118f060008301846118cc565b92915050565b6000806040838503121561190d5761190c6115c5565b5b600061191b85828601611618565b925050602083013567ffffffffffffffff81111561193c5761193b6115ca565b5b6119488582860161181c565b9150509250929050565b60008115159050919050565b61196781611952565b82525050565b6000602082019050611982600083018461195e565b92915050565b60006020828403121561199e5761199d6115c5565b5b600082013567ffffffffffffffff8111156119bc576119bb6115ca565b5b6119c88482850161181c565b91505092915050565b600060408201905081810360008301526119eb81856116ba565b90506119fa602083018461195e565b9392505050565b600081519050919050565b600082825260208201905092915050565b6000611a2882611a01565b611a328185611a0c565b9350611a42818560208601611676565b611a4b816116a9565b840191505092915050565b60006020820190508181036000830152611a708184611a1d565b905092915050565b611a81816118c2565b8114611a8c57600080fd5b50565b600081359050611a9e81611a78565b92915050565b600060208284031215611aba57611ab96115c5565b5b6000611ac884828501611a8f565b91505092915050565b600080600060608486031215611aea57611ae96115c5565b5b6000611af886828701611618565b935050602084013567ffffffffffffffff811115611b1957611b186115ca565b5b611b258682870161181c565b925050604084013567ffffffffffffffff811115611b4657611b456115ca565b5b611b528682870161181c565b9150509250925092565b6000819050919050565b611b6f81611b5c565b8114611b7a57600080fd5b50565b600081359050611b8c81611b66565b92915050565b600060208284031215611ba857611ba76115c5565b5b6000611bb684828501611b7d565b91505092915050565b60008060008060808587031215611bd957611bd86115c5565b5b6000611be787828801611a8f565b9450506020611bf887828801611a8f565b935050604085013567ffffffffffffffff811115611c1957611c186115ca565b5b611c258782880161181c565b925050606085013567ffffffffffffffff811115611c4657611c456115ca565b5b611c528782880161181c565b91505092959194509250565b611c67816115ef565b82525050565b6000604082019050611c82600083018561195e565b611c8f6020830184611c5e565b9392505050565b611c9f81611b5c565b82525050565b6000602082019050611cba6000830184611c96565b92915050565b60008060008060808587031215611cda57611cd96115c5565b5b600085013567ffffffffffffffff811115611cf857611cf76115ca565b5b611d048782880161181c565b945050602085013567ffffffffffffffff811115611d2557611d246115ca565b5b611d318782880161181c565b935050604085013567ffffffffffffffff811115611d5257611d516115ca565b5b611d5e8782880161181c565b9250506060611d6f87828801611a8f565b91505092959194509250565b600080600060608486031215611d9457611d936115c5565b5b600084013567ffffffffffffffff811115611db257611db16115ca565b5b611dbe8682870161181c565b935050602084013567ffffffffffffffff811115611ddf57611dde6115ca565b5b611deb8682870161181c565b9250506040611dfc86828701611a8f565b9150509250925092565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680611e4d57607f821691505b60208210811415611e6157611e60611e06565b5b50919050565b600081905092915050565b60008190508160005260206000209050919050565b60008154611e9481611e35565b611e9e8186611e67565b94506001821660008114611eb95760018114611eca57611efd565b60ff19831686528186019350611efd565b611ed385611e72565b60005b83811015611ef557815481890152600182019150602081019050611ed6565b838801955050505b50505092915050565b6000611f118261165a565b611f1b8185611e67565b9350611f2b818560208601611676565b80840191505092915050565b6000611f438285611e87565b9150611f4f8284611f06565b91508190509392505050565b6000611f678284611f06565b915081905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000611fdb826118c2565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82141561200e5761200d611fa1565b5b600182019050919050565b7f69647e6b6579393931643164323266323464303034346164656132383063666260008201527f633863386332343939386334623430373430373834303965333334393135333060208201527f6138393532340000000000000000000000000000000000000000000000000000604082015250565b600061209b604683611e67565b91506120a682612019565b604682019050919050565b60006120bc8261208e565b9150819050919050565b60006120d28285611f06565b91506120de8284611f06565b91508190509392505050565b60006120f5826118c2565b9150612100836118c2565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0382111561213557612134611fa1565b5b828201905092915050565b600060ff82169050919050565b600061215882612140565b915060ff82141561216c5761216b611fa1565b5b600182019050919050565b61218081612140565b82525050565b600060808201905061219b6000830187611c96565b6121a86020830186612177565b6121b56040830185611c96565b6121c26060830184611c96565b95945050505050565b60006121d682612140565b91506121e183612140565b92508260ff038211156121f7576121f6611fa1565b5b828201905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b600061223c826118c2565b9150612247836118c2565b92508261225757612256612202565b5b828204905092915050565b600061226d826118c2565b9150612278836118c2565b92508282101561228b5761228a611fa1565b5b828203905092915050565b60006122a1826118c2565b91506122ac836118c2565b9250826122bc576122bb612202565b5b82820690509291505056fe39393164316432326632346430303434616465613238306366626338633863323439393863346234303734303738343039653333343931353330613839353234653031643866636637393936373736656265633563323365356461653636353830643439616539393831623561613466656533323464363830616431356235663636643836663564316461383861336466396634363561333332383165326633383138313137633830333137346635616137333637616363646363353136613665363037613936323431313337316237366666633266396634623564306662373839393263306637646166383533663762363630353333613134663936666534a26469706673582212204ac3d8cab38cab8c4af58e416fde6cff77479f48a404659e71aaa3c66b639ec164736f6c634300080c0033'

//web3.eth.getTransactionCount(from, (err, txCount) => {console.log('error : ' + err, ' txCount : ' + txCount)})
// var txCount = web3.eth.getTransactionCount(from)
// console.log('txCount : ', txCount)
var txCount = web3.eth.getTransactionCount(web3.eth.defaultAccount, (err, txCount) => {

// txCount = 17;
const txObject = {
    nonce: txCount,
    gasPrice: '0x4A817C800',
    gas: '0x6691B7', 
    data: rawSmartContract
}



const tx = new Tx(txObject)
tx.sign(privateKey)


const serializedTx = tx.serialize()
const raw = '0x' + serializedTx.toString('hex')
console.log('raw : ',raw)



// web3.eth.sendRawTransaction(raw, (err, txHash) => {
//      console.log('txHash:', txHash) })

web3.eth.sendSignedTransaction(raw, (err, txHash) => {
	console.log('txHash:', txHash) })
})
// var sampleContract = new web3.eth.Contract([{"inputs":[{"internalType":"bytes32","name":"_bytes32","type":"bytes32"}],"name":"bytes32ToString","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"initLedger","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"pubKeyIoT","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"pubkey","type":"string"}],"name":"putAddressesToState","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"pubkey","type":"string"},{"internalType":"string","name":"id","type":"string"},{"internalType":"uint256","name":"counter","type":"uint256"}],"name":"putCounterToState","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"pubkey","type":"string"},{"internalType":"string","name":"id","type":"string"}],"name":"putIDsToState","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"pubkey","type":"string"},{"internalType":"string","name":"id","type":"string"}],"name":"queryLedger","outputs":[{"internalType":"string","name":"","type":"string"},{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_dataToStore","type":"uint256"},{"internalType":"uint256","name":"_r","type":"uint256"},{"internalType":"uint256","name":"_s","type":"uint256"}],"name":"setMyData","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"source","type":"string"}],"name":"stringToBytes32","outputs":[{"internalType":"bytes32","name":"result","type":"bytes32"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"uint256","name":"x","type":"uint256"}],"name":"toBytes","outputs":[{"internalType":"bytes","name":"b","type":"bytes"}],"stateMutability":"nonpayable","type":"function"}]);
// var sample = sampleContract.deploy({
//      data: '', 
//      arguments: [
//      ]
// }).send({
//      from: web3.eth.accounts[0], 
//      gas: '4700000'
//    }, function (e, contract){
//     console.log(e, contract);
//     if (typeof contract.address !== 'undefined') {
//          console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
//     }
//  })